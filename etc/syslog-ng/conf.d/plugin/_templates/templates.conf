template t_logscale_otel_noraw {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .otel.* --rekey .otel.* --shift-levels 1 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.ecs.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
    )');  
};

template t_logscale_otel_head_tail {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .otel.* --rekey .otel.* --shift-levels 1 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.ecs.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
      --pair event.@rawstring=$(strip "${.otel.scopeLog.logRecord.attributes.body.header}" " " "${.otel.scopeLog.logRecord.attributes.body.tail}")")
    )');  
};

template t_logscale_otel_body {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .otel.* --rekey .otel.* --shift-levels 1 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.ecs.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
      --pair event.@rawstring="${.otel.log.body}")
    )');  
};

template t_logscale_parsed_w_raw {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .Vendor.* --rekey .Vendor.* --shift-levels 1 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
      --pair event.@rawstring=$(template "${.segway.msgtemplate}")
    )');  
};

template t_logscale_parsed {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .Vendor.* --rekey .Vendor.* --shift-levels 1 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
    )');
};

template t_logscale_compat_parsed_w_raw {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .Vendor.* --rekey .Vendor.* --shift-levels 2 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
      --pair event.@rawstring=$(template "${.segway.msgtemplate}")
    )');  
};

template t_logscale_compat_parsed {
    template('$(format-json --scope none --omit-empty-values
      time=$S_UNIXTIME
      timezone=$S_TZOFFSET
      --key .Vendor.* --rekey .Vendor.* --shift-levels 2 --add-prefix event.
      --key .ecs.* --rekey .ecs.* --shift-levels 2 --add-prefix event.
      --key .logscale.hec.* --rekey .logscale.hec.* --shift-levels 3
      --key .logscale.tags.* --rekey .logscale.tags.* --shift-levels 3 --add-prefix event.#
    )');  
};
